<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Simulador de Cotización - Mudanzas</title>

  <!-- Bootstrap 5 CSS CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* Sidebar redes sociales fijo a la izquierda (oculto en dispositivos pequeños) */
    .social-fixed {
      position: fixed;
      left: 10px;
      top: 40%;
      z-index: 1050;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .social-fixed a {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 2px 6px rgba(0,0,0,.15);
      text-decoration: none;
      color: #333;
      border: 1px solid #eee;
    }
    @media (max-width: 768px) {
      .social-fixed { display: none; } /* desaparece en móvil */
    }

    /* Resultado destacado */
    .result-card { min-height: 180px; }
    .small-note { font-size: .9rem; color: #666; }

    /* Mejora visual inputs */
    .form-section { background: #fbfbfd; border-radius: .5rem; padding: 16px; margin-bottom: 16px; }
  </style>
</head>
<body class="bg-light">

  <!-- Social fixed -->
  <div class="social-fixed">
    <a href="#" title="WhatsApp" aria-label="WhatsApp"><svg width="20" height="20" viewBox="0 0 24 24"><path fill="#25D366" d="M20.5 3.5A11.9 11.9 0 0 0 12 0C5.373 0 0 5.373 0 12c0 2.116.554 4.086 1.606 5.816L0 24l6.449-1.645A11.937 11.937 0 0 0 12 24c6.627 0 12-5.373 12-12 0-1.97-.472-3.827-1.5-5.5z"/></svg></a>
    <a href="#" title="Facebook" aria-label="Facebook"><svg width="20" height="20" viewBox="0 0 24 24"><path fill="#1877F2" d="M22 12.073C22 6.48 17.523 2 11.929 2S2 6.48 2 12.073C2 17.098 5.657 21.128 10.438 21.878v-6.19H8.078v-2.995h2.36V9.845c0-2.337 1.392-3.614 3.525-3.614.997 0 2.038.178 2.038.178v2.243h-1.15c-1.135 0-1.488.703-1.488 1.423v1.713h2.528l-.404 2.995h-2.124v6.19C18.343 21.128 22 17.098 22 12.073z"/></svg></a>
    <a href="#" title="Instagram" aria-label="Instagram"><svg width="20" height="20" viewBox="0 0 24 24"><path fill="#E1306C" d="M12 2.163c3.204 0 3.584.012 4.85.07 1.17.054 1.97.24 2.426.403a4.92 4.92 0 0 1 1.79 1.04 4.92 4.92 0 0 1 1.04 1.79c.163.456.349 1.256.403 2.426.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.054 1.17-.24 1.97-.403 2.426a4.92 4.92 0 0 1-1.04 1.79 4.92 4.92 0 0 1-1.79 1.04c-.456.163-1.256.349-2.426.403-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.17-.054-1.97-.24-2.426-.403a4.92 4.92 0 0 1-1.79-1.04 4.92 4.92 0 0 1-1.04-1.79c-.163-.456-.349-1.256-.403-2.426C2.175 15.747 2.163 15.367 2.163 12s.012-3.584.07-4.85c.054-1.17.24-1.97.403-2.426a4.918 4.918 0 0 1 1.04-1.79 4.918 4.918 0 0 1 1.79-1.04c.456-.163 1.256-.349 2.426-.403C8.416 2.175 8.796 2.163 12 2.163z"/></svg></a>
  </div>

  <div class="container py-5">
    <div class="row g-4">
      <div class="col-lg-7">
        <h1 class="mb-3">Simulador de Cotización para Mudanzas</h1>
        <p class="lead small-note">Rellena los datos para obtener una estimación rápida. Esto NO reemplaza una visita técnica.</p>

        <!-- Form -->
        <form id="simulatorForm" class="border p-3 bg-white rounded shadow-sm">

          <!-- Distancia -->
          <div class="form-section">
            <h5>1. Distancia</h5>
            <div class="row g-2">
              <div class="col-md-6">
                <label class="form-label">Tipo de mudanza</label>
                <select class="form-select" id="distanceType" name="distanceType">
                  <option value="local">Mudanza Local (misma ciudad)</option>
                  <option value="regional">Mudanza Regional (entre ciudades cercanas)</option>
                  <option value="long">Mudanza Larga Distancia (nacional/internacional)</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label">Kilómetros aproximados</label>
                <input type="number" class="form-control" id="kilometers" placeholder="Ej: 10" min="0" value="10">
              </div>
            </div>
          </div>

          <!-- Volumen -->
          <div class="form-section">
            <h5>2. Volumen de bienes</h5>
            <div class="row g-2">
              <div class="col-md-6">
                <label class="form-label">Número de habitaciones</label>
                <select id="rooms" class="form-select">
                  <option value="1">Pequeña (1-2)</option>
                  <option value="3">Mediana (3-4)</option>
                  <option value="5">Grande (5+)</option>
                </select>
              </div>
              <div class="col-md-3">
                <label class="form-label">Metros cúbicos (m³)</label>
                <input type="number" class="form-control" id="m3" min="0" value="12">
              </div>
              <div class="col-md-3">
                <label class="form-label">Peso estimado (kg)</label>
                <input type="number" class="form-control" id="kg" min="0" value="200">
              </div>
            </div>
          </div>

          <!-- Tipo de bienes y embalaje -->
          <div class="form-section">
            <h5>3. Tipo de bienes y embalaje</h5>
            <div class="row">
              <div class="col-md-6">
                <label class="form-label">Embalaje</label>
                <select id="packing" class="form-select">
                  <option value="standard">Embalaje Estándar</option>
                  <option value="special">Embalaje Especial (frágiles)</option>
                  <option value="premium">Embalaje Premium</option>
                </select>
              </div>
              <div class="col-md-6">
                <label class="form-label">Bienes pesados/voluminosos</label>
                <select id="heavy" class="form-select">
                  <option value="none">No</option>
                  <option value="few">Algunos muebles pesados</option>
                  <option value="many">Varios/Equipo industrial</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Servicios adicionales -->
          <div class="form-section">
            <h5>4. Servicios adicionales</h5>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="aux" value="aux">
              <label class="form-check-label" for="aux">Auxiliares de carga y descarga</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="dismount">
              <label class="form-check-label" for="dismount">Desmontaje y Montaje de muebles</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="packingPremium">
              <label class="form-check-label" for="packingPremium">Embalaje Premium (materiales + mano de obra)</label>
            </div>
            <div class="mt-2 row g-2">
              <div class="col-md-6">
                <label class="form-label">Almacenamiento temporal (días)</label>
                <input type="number" min="0" class="form-control" id="storageDays" value="0">
              </div>
              <div class="col-md-6">
                <label class="form-label">¿Requiere seguro?</label>
                <select id="insurance" class="form-select">
                  <option value="none">No</option>
                  <option value="basic">Seguro Básico</option>
                  <option value="premium">Seguro Premium</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Complejidad y urgencia -->
          <div class="form-section">
            <h5>5. Complejidad y urgencia</h5>
            <div class="row g-2">
              <div class="col-md-4">
                <label class="form-label">Accesibilidad</label>
                <select id="access" class="form-select">
                  <option value="easy">Acceso fácil (ascensor / planta baja)</option>
                  <option value="stairs">Escaleras / acceso medio</option>
                  <option value="hard">Acceso difícil (pisos altos sin ascensor)</option>
                </select>
              </div>
              <div class="col-md-4">
                <label class="form-label">Distancia interna (metros)</label>
                <input type="number" class="form-control" id="internalDistance" min="0" value="10">
              </div>
              <div class="col-md-4">
                <label class="form-label">Urgencia</label>
                <select id="urgency" class="form-select">
                  <option value="normal">Mudanza Programada</option>
                  <option value="express">Mudanza Express</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Botones -->
          <div class="d-flex gap-2 justify-content-between align-items-center mt-3">
            <div>
              <button type="button" id="calcBtn" class="btn btn-primary">Calcular cotización</button>
              <button type="button" id="resetBtn" class="btn btn-outline-secondary">Reset</button>
            </div>
            <div class="btn-group">
              <button type="button" class="btn btn-sm btn-light" id="exampleSmall">Ejemplo: Pequeña Local</button>
              <button type="button" class="btn btn-sm btn-light" id="exampleMedium">Ejemplo: Mediana Local</button>
              <button type="button" class="btn btn-sm btn-light" id="exampleLong">Ejemplo: Larga Distancia</button>
            </div>
          </div>

        </form>

        <!-- Notas -->
        <div class="mt-3 small-note">
          <strong>Proceso:</strong> Esta es una estimación rápida. Para una propuesta final se recomienda evaluación in situ (visita técnica). Factores como tráfico, clima, cambios de volumen y solicitudes adicionales pueden alterar el precio final.
        </div>
      </div>

      <!-- Columna resultados -->
      <div class="col-lg-5">
        <div class="card result-card shadow-sm p-3">
          <h4>Resultado estimado</h4>
          <div id="resultBox" class="mt-3">
            <p class="text-muted">Aún no has calculado una cotización. Presiona <strong>Calcular cotización</strong>.</p>
          </div>
        </div>

        <div class="card mt-3 p-3 shadow-sm">
          <h6>Ejemplos de cotizaciones (referencia)</h6>
          <ul class="mb-0 small-note">
            <li>Mudanza Pequeña Local (1 hab) — $150.000 - $250.000 COP</li>
            <li>Mudanza Mediana Local (3 hab) — $350.000 - $550.000 COP</li>
            <li>Mudanza Larga Distancia — $800.000 - $1.500.000 COP</li>
            <li>Mudanza con Embalaje Premium — $600.000 - $1.200.000 COP</li>
          </ul>
        </div>

      </div>
    </div>
  </div>

  <!-- jQuery and Bootstrap Bundle JS (no other frameworks) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Lógica de cotización (valores base/multiplicadores aproximados)
    $(function() {

      function calcular() {
        // Leer inputs
        const distanceType = $('#distanceType').val();
        const km = Number($('#kilometers').val()) || 0;
        const rooms = Number($('#rooms').val()); // 1,3,5
        const m3 = Number($('#m3').val()) || 0;
        const kg = Number($('#kg').val()) || 0;
        const packing = $('#packing').val();
        const heavy = $('#heavy').val();
        const aux = $('#aux').is(':checked');
        const dismount = $('#dismount').is(':checked');
        const packingPremium = $('#packingPremium').is(':checked');
        const storageDays = Number($('#storageDays').val()) || 0;
        const insurance = $('#insurance').val();
        const access = $('#access').val();
        const internalDistance = Number($('#internalDistance').val()) || 0;
        const urgency = $('#urgency').val();

        // Parámetros base (ajustables)
        let baseLocal = 140000; // base aproximada para mudanza local pequeña
        // Multiplicadores por tipo de distancia
        const distanceMultiplier = (distanceType === 'local') ? 1.0 : (distanceType === 'regional') ? 1.9 : 3.5;

        // Cargo por km adicional (aplica más para regional/larga)
        const perKm = (distanceType === 'local') ? 1500 : (distanceType === 'regional') ? 2200 : 3200;
        const kmCharge = Math.max(0, km - 5) * perKm; // primeros 5 km incluidos en base

        // Rooms multiplier (aprox)
        const roomMultiplier = (rooms === 1) ? 1.0 : (rooms === 3) ? 1.8 : 3.0;

        // Cargo por volumen y peso
        const chargePerM3 = 8000; // por m3
        const chargePerKg = 80; // por kg
        const volumeCharge = m3 * chargePerM3;
        const weightCharge = kg * chargePerKg;

        // Tipo de embalaje
        let packingMultiplier = 1.0;
        if (packing === 'special') packingMultiplier = 1.15;
        if (packing === 'premium') packingMultiplier = 1.35;

        // Bienes pesados
        let heavyFixed = 0;
        if (heavy === 'few') heavyFixed = 80000;
        if (heavy === 'many') heavyFixed = 200000;

        // Servicios adicionales (costos fijos aproximados)
        const auxCost = aux ? 90000 : 0;
        const dismountCost = dismount ? 120000 : 0;
        const packingPremiumCost = packingPremium ? 180000 : 0;
        const storageCostPerDay = 50000;
        const storageCost = storageDays * storageCostPerDay;

        // Complejidad / accesibilidad
        let accessMultiplier = 1.0;
        if (access === 'stairs') accessMultiplier = 1.18;
        if (access === 'hard') accessMultiplier = 1.35;

        // Distancia interna (si es mayor a 20 metros incrementar)
        const internalDistanceExtra = (internalDistance > 20) ? (internalDistance - 20) * 500 : 0;

        // Urgencia
        const urgencyMultiplier = (urgency === 'express') ? 1.4 : 1.0;

        // Calculo subtotal (antes de servicios fijos)
        let subtotal = (baseLocal * distanceMultiplier * roomMultiplier) + kmCharge + volumeCharge + weightCharge;
        subtotal = subtotal * packingMultiplier;
        subtotal = subtotal * accessMultiplier;
        subtotal = subtotal * urgencyMultiplier;
        subtotal += internalDistanceExtra;

        // Sumar servicios fijos
        let servicesTotal = auxCost + dismountCost + packingPremiumCost + heavyFixed + storageCost;

        // Seguro
        let insuranceCost = 0;
        if (insurance === 'basic') insuranceCost = Math.round((subtotal + servicesTotal) * 0.01); // 1%
        if (insurance === 'premium') insuranceCost = Math.round((subtotal + servicesTotal) * 0.025); // 2.5%

        // Suma total estimada
        let total = subtotal + servicesTotal + insuranceCost;

        // Rango estimado (incertidumbre por cambios in situ)
        const minEstimate = Math.round(total * 0.85);
        const maxEstimate = Math.round(total * 1.15);

        // Redondeos para presentación
        function formatCOP(n) {
          return n.toLocaleString('es-CO', { style: 'currency', currency: 'COP', maximumFractionDigits: 0 });
        }

        // Construir HTML de resultado
        let html = '';
        html += `<div class="mb-3"><h5 class="mb-1">${formatCOP(Math.round((minEstimate+maxEstimate)/2))} <small class="text-muted"> (estimado)</small></h5>`;
        html += `<p class="mb-0 small-note">Rango estimado: <strong>${formatCOP(minEstimate)}</strong> — <strong>${formatCOP(maxEstimate)}</strong></p></div>`;

        html += '<hr>';
        html += '<h6>Desglose</h6>';
        html += '<ul class="small-note">';
        html += `<li>Subtotal base y distancia: <strong>${formatCOP(Math.round(subtotal))}</strong></li>`;
        if (kmCharge > 0) html += `<li>Cargo por km adicional: ${formatCOP(Math.round(kmCharge))}</li>`;
        if (volumeCharge > 0) html += `<li>Cargo por volumen (${m3} m³): ${formatCOP(Math.round(volumeCharge))}</li>`;
        if (weightCharge > 0) html += `<li>Cargo por peso (${kg} kg): ${formatCOP(Math.round(weightCharge))}</li>`;
        if (servicesTotal > 0) html += `<li>Servicios/Extras: ${formatCOP(Math.round(servicesTotal))}</li>`;
        if (insuranceCost > 0) html += `<li>Seguro (${insurance}): ${formatCOP(Math.round(insuranceCost))}</li>`;
        html += '</ul>';

        html += '<hr>';
        html += `<p class="mb-1"><strong>Total estimado:</strong> ${formatCOP(Math.round(total))}</p>`;
        html += '<p class="small-note mb-0"><strong>Notas:</strong> Esta estimación no incluye peajes, permisos especiales ni cobros por condiciones excepcionales. Para confirmar se recomienda visita técnica.</p>';

        $('#resultBox').html(html);

        // Return object in case needed
        return {
          subtotal: subtotal,
          servicesTotal: servicesTotal,
          insuranceCost: insuranceCost,
          total: total,
          minEstimate: minEstimate,
          maxEstimate: maxEstimate
        };
      }

      // Handlers
      $('#calcBtn').on('click', function(e) {
        e.preventDefault();
        calcular();
        // Scroll to result on small screens
        $('html, body').animate({ scrollTop: $('#resultBox').offset().top - 20 }, 300);
      });

      $('#resetBtn').on('click', function(){
        $('#simulatorForm')[0].reset();
        // restore defaults for numeric inputs
        $('#kilometers').val(10); $('#m3').val(12); $('#kg').val(200); $('#storageDays').val(0); $('#internalDistance').val(10);
        $('#resultBox').html('<p class="text-muted">Aún no has calculado una cotización. Presiona <strong>Calcular cotización</strong>.</p>');
      });

      // Ejemplos
      $('#exampleSmall').on('click', function() {
        $('#distanceType').val('local'); $('#kilometers').val(8);
        $('#rooms').val(1); $('#m3').val(8); $('#kg').val(120);
        $('#packing').val('standard'); $('#heavy').val('none');
        $('#aux').prop('checked', true); $('#dismount').prop('checked', false); $('#packingPremium').prop('checked', false);
        $('#storageDays').val(0); $('#insurance').val('basic'); $('#access').val('easy'); $('#internalDistance').val(6); $('#urgency').val('normal');
        calcular();
      });

      $('#exampleMedium').on('click', function() {
        $('#distanceType').val('local'); $('#kilometers').val(12);
        $('#rooms').val(3); $('#m3').val(24); $('#kg').val(420);
        $('#packing').val('standard'); $('#heavy').val('few');
        $('#aux').prop('checked', true); $('#dismount').prop('checked', true); $('#packingPremium').prop('checked', false);
        $('#storageDays').val(0); $('#insurance').val('basic'); $('#access').val('stairs'); $('#internalDistance').val(12); $('#urgency').val('normal');
        calcular();
      });

      $('#exampleLong').on('click', function() {
        $('#distanceType').val('long'); $('#kilometers').val(400);
        $('#rooms').val(3); $('#m3').val(20); $('#kg').val(450);
        $('#packing').val('special'); $('#heavy').val('few');
        $('#aux').prop('checked', true); $('#dismount').prop('checked', true); $('#packingPremium').prop('checked', true);
        $('#storageDays').val(3); $('#insurance').val('premium'); $('#access').val('stairs'); $('#internalDistance').val(8); $('#urgency').val('normal');
        calcular();
      });

      // Run default calculation once
      // calcular(); // no ejecutamos automáticamente para dejar al usuario controlar

    });
  </script>
</body>
</html>
